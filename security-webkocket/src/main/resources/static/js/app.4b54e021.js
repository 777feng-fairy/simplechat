(function(t){function e(e){for(var n,r,a=e[0],c=e[1],l=e[2],d=0,f=[];d<a.length;d++)r=a[d],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&f.push(i[r][0]),i[r]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);u&&u(e);while(f.length)f.shift()();return o.push.apply(o,l||[]),s()}function s(){for(var t,e=0;e<o.length;e++){for(var s=o[e],n=!0,a=1;a<s.length;a++){var c=s[a];0!==i[c]&&(n=!1)}n&&(o.splice(e--,1),t=r(r.s=s[0]))}return t}var n={},i={app:0},o=[];function r(e){if(n[e])return n[e].exports;var s=n[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=t,r.c=n,r.d=function(t,e,s){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(s,n,function(e){return t[e]}.bind(null,n));return s},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=e,a=a.slice();for(var l=0;l<a.length;l++)e(a[l]);var u=c;o.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"034f":function(t,e,s){"use strict";var n=s("85ec"),i=s.n(n);i.a},2154:function(t,e,s){},2289:function(t,e,s){},"56d7":function(t,e,s){"use strict";s.r(e);s("e260"),s("e6cf"),s("cca6"),s("a79d");var n=s("2b0e"),i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("router-view")],1)},o=[],r={name:"app",created:function(){var t=this;sessionStorage.getItem("store")&&(this.$store.replaceState(Object.assign({},this.$store.state,JSON.parse(sessionStorage.getItem("store")))),sessionStorage.removeItem("store")),window.addEventListener("beforeunload",(function(){sessionStorage.setItem("store",JSON.stringify(t.$store.state))}))}},a=r,c=(s("034f"),s("2877")),l=Object(c["a"])(a,i,o,!1,null,null,null),u=l.exports,d=s("8c4f"),f=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"login"},[s("div",{staticClass:"login-content"},[s("div",[s("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"status-icon":""}},[s("el-form-item",{attrs:{label:"账号",prop:"account"}},[s("el-input",{attrs:{"prefix-icon":"el-icon-user"},model:{value:t.form.account,callback:function(e){t.$set(t.form,"account",e)},expression:"form.account"}})],1),s("el-form-item",{attrs:{label:"密码",prop:"password"}},[s("el-input",{attrs:{type:"password","prefix-icon":"el-icon-key","show-password":""},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:t.clickBtn}},[t._v("登录")])],1)],1)],1),s("div",{staticClass:"login-popper"},[s("el-popover",{attrs:{trigger:"manual","popper-class":"popper"},model:{value:t.visiable,callback:function(e){t.visiable=e},expression:"visiable"}},[s("slider-block",{on:{ispass:t.pass,close:t.close}})],1)],1)])])},p=[],h=(s("ac1f"),s("5319"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"sliderblock"},[s("div",{staticClass:"sliderblock-cav"},[s("canvas",{ref:"bc",attrs:{width:"300px",height:"250px"}}),s("canvas",{ref:"sc",attrs:{width:"300px",height:"250px"}})]),s("div",{staticClass:"sliderblock-slider"},[s("div",{staticClass:"sliderblock-slider-block"},[s("span",{class:{textcolorsuccess:t.checkpass}},[t._v(t._s(t.tip))])]),s("div",{staticClass:"el-icon-d-arrow-right sliderblock-slider-blocker",on:{mousedown:function(e){return e.preventDefault(),t.drop(e)}}}),s("div",{staticClass:"sliderblock-close"},[s("i",{staticClass:"el-icon-close",staticStyle:{cursor:"pointer"},attrs:{title:"点击关闭"},on:{click:t.close}})])])])}),m=[],v=(s("cb29"),s("dd77")),g=s.n(v),b={data:function(){return{block:{width:40,circlur_r:10,x:0,y:120},backimage:g.a,tip:"滑动滑块完成验证",checkpass:!1}},methods:{init:function(){var t=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)},e=t(120,240);this.block.x=e,this.createCanvas()},createCanvas:function(){var t=this.$refs["bc"],e=this.$refs["sc"],s=t.width,n=t.height,i=t.getContext("2d"),o=e.getContext("2d");t.width=s,t.height=n,e.width=s,e.height=n;var r=document.createElement("img"),a=this.block;r.onload=function(){i.drawImage(r,0,0,300,250),o.drawImage(r,0,0,300,250);var t=a.width+2*a.circlur_r-4,s=o.getImageData(a.x,a.y-2*a.circlur_r+4,t,t);e.width=t,o.putImageData(s,0,a.y-2*a.circlur_r+4)},r.src=this.backimage,this.drawBlock(o,a,"clip"),this.drawBlock(i,a,"fill")},drawBlock:function(t,e,s){t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(e.x+e.width/2,e.y),t.arc(e.x+e.width/2,e.y-e.circlur_r+4,e.circlur_r,0,2*Math.PI),t.lineTo(e.x+e.width/2,e.y),t.lineTo(e.x+e.width,e.y),t.lineTo(e.x+e.width,e.y+e.width/2),t.arc(e.x+e.width+e.circlur_r-4,e.y+e.width/2,e.circlur_r,0,2*Math.PI),t.lineTo(e.x+e.width,e.y+e.width/2),t.lineTo(e.x+e.width,e.y+e.width),t.lineTo(e.x,e.y+e.width),t.lineTo(e.x,e.y),t[s](),t.beginPath(),t.arc(e.x,e.y+e.width/2,e.circlur_r,1.5*Math.PI,.5*Math.PI),t.globalCompositeOperation="xor",t.fill()},drop:function(t){var e=this,s=t.target,n=this.$refs["sc"],i={x:t.x,y:t.y},o=this.block,r=0,a=function(t){if(r=t.x-i.x,r>300||r<0)return!1;s.style.left=r+"px",n.style.left=r+"px"},c=function t(r){document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",t);var c={x:r.x,y:r.y},l=c.x-i.x;o.x-1<=l&&l<=o.x+1?(e.checkpass=!0,e.tip="验证通过",s.style.left="",setTimeout((function(){e.$emit("ispass",!0),n.style.left="",e.tip="滑动滑块完成验证",e.checkpass=!1}),800)):(s.style.left="",n.style.left="",e.init())};document.addEventListener("mousemove",a),document.addEventListener("mouseup",c)},close:function(){var t=this;this.$emit("close",!1),setTimeout((function(){t.init()}),200)}},mounted:function(){this.init()}},w=b,y=(s("f27b"),Object(c["a"])(w,h,m,!1,null,null,null)),x=y.exports,k={name:"login",components:{SliderBlock:x},data:function(){var t=function(t,e,s){if(!e)return s(new Error("请填入"));s()};return{visiable:!1,checkpass:!1,form:{account:"",password:""},rules:{account:[{validator:t,trigger:"blur"}],password:[{validator:t,trigger:"blur"}]}}},methods:{pass:function(t){this.visiable=!1,this.checkpass=t},clickBtn:function(){var t=this,e=this.$refs["form"];e.validate((function(e){e&&(t.visiable=!0)}))},postLogin:function(){var t=this,e=this.$refs["form"];this.axios({url:"/api/user/login",method:"post",params:{account:e.model.account,password:e.model.password}}).then((function(s){200==s.data.status&&(t.$store.commit("updateUser",s.data.data),t.$router.replace({path:"/chat"})),400==s.data.status&&(t.checkpass=!1,t.$message.warning("哎呀！登陆失败了"),e.resetFields())})).catch((function(e){t.checkpass=!1,t.$message.error("哎呀！报错了0.0！请检查网络连接")}))},close:function(t){this.visiable=t}},watch:{checkpass:function(t){t&&this.postLogin()}}},_=k,S=(s("66c0"),Object(c["a"])(_,f,p,!1,null,null,null)),C=S.exports,$=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"chat"},[s("div",{ref:"win",staticClass:"chat-window"},t._l(t.messages,(function(t,e){return s("div",{key:e},[s("chat-message",{ref:"message",refInFor:!0,attrs:{model:t}})],1)})),0),s("div",{staticClass:"chat-input clearfix"},[s("div",{staticStyle:{float:"left",width:"85%"}},[s("el-input",{model:{value:t.message,callback:function(e){t.message=e},expression:"message"}})],1),s("div",{staticStyle:{float:"right",width:"auto"}},[s("el-button",{attrs:{type:"primary",round:""},on:{click:t.postMsg}},[t._v("发送")])],1)])])},O=[],M=(s("d3b7"),s("4d63"),s("25f0"),s("4d90"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"chatmessage"},[s("div",[s("span",[t._v(t._s(t.model.from))]),s("span",[t._v("（"+t._s(t.model.time)+"）")])]),s("div",[s("span",{staticClass:"chatmessage-qipao"},[t._v(t._s(t.model.message))])])])}),j=[],T={props:{model:{type:Object,default:""}}},E=T,I=(s("81dd"),Object(c["a"])(E,M,j,!1,null,null,null)),P=I.exports,B=s("74d1"),L=s.n(B),J=s("cc7d"),D=s.n(J),F={components:{ChatMessage:P},methods:{postMsg:function(){var t=this.message,e=this.dateFormat("HH:MM:SS",new Date),s=this.user.account,n={from:s,message:t,to:"",time:e};this.stompClient.send("/api/user/wechat",{},JSON.stringify(n)),this.message=""},scollBottom:function(){var t=this.$refs["win"];t.scrollTop=t.scrollHeight},messageType:function(){var t=this.messages.length,e=this.user.account;if(0!==t){var s=this.messages[t-1];if(s.from!==e){var n=this.$refs.message[t-1];n.$el.style.textAlign="left"}}},initWebSocket:function(){var t=new D.a("/wschat");this.stompClient=L.a.over(t);var e=this;this.stompClient.connect({},(function(t){var s=e;e.stompClient.subscribe("/topic/groupchat",(function(t){var e=JSON.parse(t.body);s.messages.push(e)}))}))},disconnect:function(){null!==this.stompClient&&this.stompClient.disconnect()},dateFormat:function(t,e){var s,n={"Y+":e.getFullYear().toString(),"m+":(e.getMonth()+1).toString(),"d+":e.getDate().toString(),"H+":e.getHours().toString(),"M+":e.getMinutes().toString(),"S+":e.getSeconds().toString()};for(var i in n)s=new RegExp("("+i+")").exec(t),s&&(t=t.replace(s[1],1==s[1].length?n[i]:n[i].padStart(s[1].length,"0")));return t}},data:function(){return{messages:[],message:"",stompClient:null}},updated:function(){this.scollBottom(),this.messageType()},destroyed:function(){this.disconnect()},mounted:function(){this.initWebSocket()},computed:{user:function(){return this.$store.state.user}}},H=F,N=(s("df13"),Object(c["a"])(H,$,O,!1,null,null,null)),q=N.exports;n["default"].use(d["a"]);var U=[{name:"login",path:"/login",component:C},{name:"chat",path:"/chat",component:q}],W=new d["a"]({mode:"history",base:"/views/",routes:U}),Y=W,z=s("2f62");n["default"].use(z["a"]);var A=new z["a"].Store({state:{user:{account:"pqv"}},mutations:{updateUser:function(t,e){t.user=e}},actions:{},modules:{}}),R=s("5c96"),G=s.n(R),K=(s("0fae"),s("bc3a")),Q=s.n(K);n["default"].use(G.a),n["default"].prototype.axios=Q.a,n["default"].config.productionTip=!1,new n["default"]({router:Y,store:A,render:function(t){return t(u)}}).$mount("#app")},"66c0":function(t,e,s){"use strict";var n=s("2154"),i=s.n(n);i.a},"71c3":function(t,e,s){},"748a":function(t,e,s){},"81dd":function(t,e,s){"use strict";var n=s("748a"),i=s.n(n);i.a},"85ec":function(t,e,s){},dd77:function(t,e,s){t.exports=s.p+"img/yzm.da1ee0aa.jpg"},df13:function(t,e,s){"use strict";var n=s("2289"),i=s.n(n);i.a},f27b:function(t,e,s){"use strict";var n=s("71c3"),i=s.n(n);i.a}});
//# sourceMappingURL=app.4b54e021.js.map